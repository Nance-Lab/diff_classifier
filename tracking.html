<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tracking particles with diff_classifier &mdash; diff_classifier 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="diff_classifier 0.1 documentation" href="index.html" />
    <link rel="next" title="Calculating features with diff_classifier" href="features_analysis.html" />
    <link rel="prev" title="Getting started with diff_classifier" href="getting_started.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tracking-particles-with-diff-classifier">
<span id="tracking-label"></span><h1>Tracking particles with diff_classifier<a class="headerlink" href="#tracking-particles-with-diff-classifier" title="Permalink to this headline">¶</a></h1>
<p>The &#8220;track&#8221; function in diff_classifier operates by creating a temporary script
files in the TEMP directory and generating a command send through the shell
to ImageJ.  User inputs include tracking parameters and spot and track filter
cutoffs.</p>
<p>This implementation is fairly constrained from the complete number of parameters
that Trackmate offers, but will be expanded in the future.  The parameters that
are currently implemented are:</p>
<ul class="simple">
<li>radius: estimated radius of spots in videos.  In general, should be slightly
larger than the average particle size in the videos.  Note that the GUI
interface uses diameter rather than radius.</li>
<li>threshold: Not used atm.</li>
<li>do_median_filtering: If set to True, filters the image before performing tracking to minimize noise.</li>
<li>quality: Lower threshold on spot quality filter. Usually varies anywhere between 1 to 300.</li>
<li>x: Upper threshold on x coordinate spot filter.</li>
<li>y: Upper threshold on y coordinate spot filter.</li>
<li>ylo: Lower threshold on y coordinate spot filter.</li>
<li>linking_max_distance: max distance in pixels that a particle can travel between
frames.</li>
<li>gap_closing_max_distance: max distance in pixels that a particle can travel when
it skips a frame.</li>
<li>track_displacement: meant to be duration.  Minimum number of frames a trajectory
must have to be included in the final dataset.</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="n">track</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">out_file</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fiji_bin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span>
      <span class="n">do_median_filtering</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">511</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">511</span><span class="p">,</span> <span class="n">ylo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">median_intensity</span><span class="o">=</span><span class="mf">55000.0</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
      <span class="n">linking_max_distance</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">gap_closing_max_distance</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">max_frame_gap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
      <span class="n">track_displacement</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="selecting-trajectory-parameters">
<h2>Selecting trajectory parameters<a class="headerlink" href="#selecting-trajectory-parameters" title="Permalink to this headline">¶</a></h2>
<p>One difficulty with particle tracking technology is that there is no easy way to
determine the &#8220;correct&#8221; tracking parameters for different videos.  Even videos
collected in the same conditions using the same particles can have different
optimal tracking parameters.  Parameters can also vary from user to user.  How
does one select optimal parameters, especially where tracking large numbers of
videos?</p>
<p>I am still working on this problem, but I have tried a few different things.
First, if you have a relatively homogeneous selection of videos with similar
particle sizes and uniform illumination, you can get away with using a single
set of parameters for all videos.</p>
<p>A second solution I have used in the situation is a set of two quality values
depending on whether the image is high-intensity or low-intensity.  I found a
fairly strong correlation between quality and mean intensity of the image, and
this has worked pretty well.  Using a simple if statement after calculating the
mean intensity of the first image can improve tracking significantly. I have
found that in general, the most sensitive parameters is the quality cutoff.  All
other parameters can remain constant.</p>
</div>
<div class="section" id="using-regression-to-predict-quality">
<h2>Using regression to predict quality<a class="headerlink" href="#using-regression-to-predict-quality" title="Permalink to this headline">¶</a></h2>
<p>The final solution that I have been toying with is using a regression technique
to predict tracking parameters based on image minimum, average, maximum, and
standard deviation intensities.  In order to implement this method, the user must
first build a training dataset (~20 videos) by using the Trackmate GUI to manually
find the best quality cutoffs for a random sample of videos from the entire set
of videos to analyze.  Then the scikit-learn toolbox can be used to select a
regression technique to predict the quality.</p>
<p>An example of such an implementation can be found
<a class="reference external" href="https://github.com/ccurtis7/diff_classifier/blob/master/notebooks/03_07_18_knn_implementation.ipynb">here</a>.</p>
</div>
<div class="section" id="imagej-module">
<h2>Imagej module<a class="headerlink" href="#imagej-module" title="Permalink to this headline">¶</a></h2>
<div class="toggle container">
<div class="header container">
diff_classifier.imagej</div>
<div class="autoclass-content container">
<span class="target" id="module-diff_classifier.imagej"></span><dl class="function">
<dt id="diff_classifier.imagej.partition_im">
<code class="descclassname">diff_classifier.imagej.</code><code class="descname">partition_im</code><span class="sig-paren">(</span><em>tiffname</em>, <em>irows=int</em>, <em>icols=int</em>, <em>ires=int</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diff_classifier/imagej.html#partition_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diff_classifier.imagej.partition_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions a 2048x2044 image into irows x icols images of size ires x ires and saved them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tiffname</strong> (<a class="reference external" href="https://docs.python.org/library/string.html#module-string" title="(in Python v3.6)"><em>string</em></a>) &#8211; Location of input image to be partitioned.</li>
<li><strong>irows</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) &#8211; Number of rows of size ires pixels to be partitioned from source image.</li>
<li><strong>icols</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) &#8211; Number of columns of size ires pixels to be partitioned from source image.</li>
<li><strong>ires</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) &#8211; Output images are of size ires x ires pixels.</li>
<li><strong>Examples</strong> &#8211; </li>
<li><strong>----------</strong> &#8211; </li>
<li><strong>partition_im('your/sample/image.tif', irows=8, icols=8, ires=256)</strong> (<em>&gt;&gt;&gt;</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="diff_classifier.imagej.track">
<code class="descclassname">diff_classifier.imagej.</code><code class="descname">track</code><span class="sig-paren">(</span><em>target</em>, <em>out_file</em>, <em>template=None</em>, <em>fiji_bin=None</em>, <em>radius=2.5</em>, <em>threshold=5.0</em>, <em>do_median_filtering=False</em>, <em>quality=30.0</em>, <em>x=511</em>, <em>y=511</em>, <em>ylo=1</em>, <em>median_intensity=55000.0</em>, <em>snr=0.0</em>, <em>linking_max_distance=10.0</em>, <em>gap_closing_max_distance=10.0</em>, <em>max_frame_gap=3</em>, <em>track_displacement=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diff_classifier/imagej.html#track"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diff_classifier.imagej.track" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>target <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Full path to a tif file to do tracking on.
Can also be a URL (e.g., &#8216;<a class="reference external" href="http://fiji.sc/samples/FakeTracks.tif">http://fiji.sc/samples/FakeTracks.tif</a>&#8216;)</dd>
<dt>out_file <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Full path to a csv file to store the results.</dd>
<dt>template <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>The full path of a template for tracking. Defaults to use
<cite>data/trackmate_template.py</cite> stored in the diff_classifier source-code.</dd>
</dl>
</dd></dl>

</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">diff_classifier</a></h1>



<p class="blurb">Analyze and visualize trajectory data from ImageJ</p>



<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ccurtis7&repo=diff_classifier&type=star&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">tracking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#selecting-trajectory-parameters">Selecting trajectory parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-regression-to-predict-quality">Using regression to predict quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imagej-module">Imagej module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features_analysis.html">features_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="interacting_with_s3.html">interacting with s3</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloudknot_parallelization.html">cloudknot_parallelization</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ccurtis7/diff_classifier/tree/master/notebooks">examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ccurtis7/diff_classifier">code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ccurtis7/diff_classifier/issues">bugs</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Chad Curtis, Ariel Rokem.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/tracking.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>